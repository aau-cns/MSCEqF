<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MSCEqF: MSCEqF</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="msceqf_logo_docs.png"/></td>
  <td id="projectalign">
   <div id="projectname">MSCEqF<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Multi State Constraint Equivariant Filter for visual inertial navigation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">MSCEqF </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> <a href="./LICENSE"><img src="https://img.shields.io/badge/License-AAUCNS-336B81.svg" alt="License" style="pointer-events: none;" class="inline"/></a></p>
<p><img src="./resources/msceqf_logo.png" alt="MSCEqF logo" class="inline"/></p>
<blockquote class="doxtable">
<p>&zwj;MSCEqF: Multi State Constraint Equivariant Filter </p>
</blockquote>
<p>MSCEqF is a multi-state constraint equivariant filter for visual-inertial navigation. It is based on the recent advances in equivaraint inertial navigation systems [1, 2, 3, 4].</p>
<h2><a class="anchor" id="autotoc_md0"></a>
Features</h2>
<h3><a class="anchor" id="autotoc_md1"></a>
Design features</h3>
<ul>
<li>Developed as a pure C++ library with ROS1 and ROS2 wrappers available</li>
</ul>
<h3><a class="anchor" id="autotoc_md2"></a>
Filter features</h3>
<ul>
<li>Supports online camera extrinsic and intrinsic parameters calibration</li>
<li>Supports unit-plane projection method</li>
<li>Supports anchored euclidean, anchored inverse depth and anchored polar feature representation methods</li>
<li>Includes a static initialization routine as well as parametric initialization with custom origin</li>
<li>Includes an equivariant zero velocity update routine</li>
</ul>
<h3><a class="anchor" id="autotoc_md3"></a>
Vision frontend features</h3>
<ul>
<li>OpenCV based</li>
<li>Supports a grid-based multi-thread parallel feature extraction</li>
<li>Supports different features detector including FAST and Shi-Tomasi</li>
<li>Supports different image enhancment tecniques, including Histogram and CLAHE</li>
</ul>
<h3><a class="anchor" id="autotoc_md4"></a>
Future roadmap</h3>
<ul class="check">
<li class="checked">ROS1 wrapper</li>
</ul>
<ul class="check">
<li class="checked">ROS2 wrapper</li>
</ul>
<ul class="check">
<li class="checked">Equivariant Zero velocity Update (EqZVU)</li>
<li class="unchecked">Unit-sphere projection method support</li>
</ul>
<ul class="check">
<li class="unchecked">Equivariant Persistent (SLAM) features update support</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
Documentation</h2>
<p>Doxygen documentation is available here: <a href="https://aau-cns.github.io/MSCEqF">MSCEqF documentation</a></p>
<h2><a class="anchor" id="autotoc_md6"></a>
Dependencies</h2>
<p>MSCEqF has the following dependencies which are automatically downloaded and linked against:</p>
<ul>
<li><a href="https://gitlab.com/libeigen/eigen.git">Eigen</a></li>
<li><a href="https://github.com/aau-cns/Lie-plusplus">Lie++</a></li>
<li><a href="https://github.com/jbeder/yaml-cpp">yaml-cpp</a></li>
<li><a href="https://github.com/google/googletest.git">googletest</a></li>
<li><a href="https://github.com/boostorg/boost.git">Boost</a></li>
<li><a href="https://github.com/opencv/opencv.git">OpenCV</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
Getting started</h2>
<h3><a class="anchor" id="autotoc_md8"></a>
ROS free setup</h3>
<div class="fragment"><div class="line">$ git clone &lt;url&gt; msceqf</div>
<div class="line">$ cd msceqf</div>
<div class="line">$ mkdir -p build/&lt;build_type&gt;</div>
<div class="line">$ cd build/&lt;build_type&gt; &amp;&amp; cmake -DCMAKE_BUILD_TYPE=&lt;build_type&gt; -DBUILD_TESTS=ON ../..</div>
<div class="line">$ cmake --build . --config Debug --target all -j &amp;&amp; cd ../..</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md9"></a>
Run tests</h3>
<div class="fragment"><div class="line">$ cd msceqf/build/&lt;build_type&gt;</div>
<div class="line">$ ./msceqf_tests</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10"></a>
Run example (Euroc)</h3>
<p>After downloading the <a href="https://projects.asl.ethz.ch/datasets/doku.php?id=kmavvisualinertialdatasets">Euroc</a> follows</p>
<div class="fragment"><div class="line">$ cd msceqf/build/&lt;build_type&gt;</div>
<div class="line">$ ./msceqf_euroc &lt;sequence_name&gt; &lt;euroc_dataset_folder&gt; &lt;euroc_example_folder&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md11"></a>
ROS1 setup</h3>
<div class="fragment"><div class="line">$ cd ws/src</div>
<div class="line">$ git clone &lt;url&gt; msceqf</div>
<div class="line">$ cd msceqf</div>
<div class="line">$ catkin build -DCMAKE_BUILD_TYPE=&lt;build_type&gt; -DROS_BUILD=ON</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md12"></a>
ROS2 setup</h3>
<div class="fragment"><div class="line">$ cd ws/src</div>
<div class="line">$ git clone &lt;url&gt; msceqf</div>
<div class="line">$ cd msceqf</div>
<div class="line">$ colcon build --event-handlers console_cohesion+ --cmake-args -DCMAKE_BUILD_TYPE=&lt;build_type&gt; --cmake-args -DROS_BUILD=ON</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md13"></a>
Docker setup</h3>
<div class="fragment"><div class="line">$ sudo apt update</div>
<div class="line">$ sudo apt install -y nvidia-docker2</div>
<div class="line">$ sudo systemctl restart docker</div>
<div class="line">$ cd &lt;path_to_msceqf_folder&gt;</div>
<div class="line">$ docker build --network=host -t msceqf:ros&lt;ros_version&gt; -f docker/Dockerfile_ros&lt;ros_version&gt;</div>
<div class="line">$ xhost +</div>
<div class="line">$ docker run --net=host -it --gpus all --env=&quot;NVIDIA_DRIVER_CAPABILITIES=all&quot; --env=&quot;DISPLAY&quot; --env=&quot;QT_X11_NO_MITSHM=1&quot; --volume=&quot;/tmp/.X11-unix:/tmp/.X11-unix:rw&quot; msceqf:ros&lt;ros_version&gt; .</div>
</div><!-- fragment --><p>If Nvidia drivere are not supported, simply run docker as follows</p>
<div class="fragment"><div class="line">$ docker run --net=host -it --gpus all --env=&quot;NVIDIA_DRIVER_CAPABILITIES=all&quot; --env=&quot;DISPLAY&quot; --env=&quot;QT_X11_NO_MITSHM=1&quot; --volume=&quot;/tmp/.X11-unix:/tmp/.X11-unix:rw&quot; msceqf:ros&lt;ros_version&gt; .</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Usage with custom dataset and/or with ROS</h2>
<p>Utilizing MSCEqF with a custom dataset or specific sensors is a straightforward process. Follow these steps for seamless integration:</p>
<h3><a class="anchor" id="autotoc_md15"></a>
Dataset/Sensor preparation</h3>
<p>Ensure you possess the camera intrinsic and extrinsic parameters calibration if working with a custom dataset. In case you are working with real sensors, perform a camera calibration before starting. We recommend using <a href="https://github.com/ethz-asl/kalibr">Kalibr</a> for efficient camera calibration.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
MSCEqF configuration file</h3>
<p>Navigate to the desired location to store the filter configuration file:</p>
<div class="fragment"><div class="line">cd &lt;path_where_to_store_the_filter_configfile&gt;</div>
<div class="line">nano &lt;configfile_name&gt;.yaml</div>
</div><!-- fragment --><p>Populate your configuration file with the following settings:</p>
<div class="fragment"><div class="line"># Initial standard deviations (attitude, velocity, position, bias, extrinsics, instrinsics)</div>
<div class="line">extended_pose_std: [1.0e-1, 1.0e-1, 1.0e-9, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-9, 1.0e-9, 1.0e-9]</div>
<div class="line">bias_std: [1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1]</div>
<div class="line">extrinsics_std: [1.0e-2, 1.0e-2, 1.0e-2, 1.0e-2, 1.0e-2, 1.0e-2]</div>
<div class="line">intrinsics_std: [1.0, 1.0, 1.0, 1.0]</div>
<div class="line"> </div>
<div class="line"># IMU noise statistics</div>
<div class="line">accelerometer_noise_density: 1.0-2</div>
<div class="line">accelerometer_random_walk:   1.0e-3</div>
<div class="line">gyroscope_noise_density: 1.0e-3</div>
<div class="line">gyroscope_random_walk:   1.0e-4</div>
<div class="line"> </div>
<div class="line"># Camera calibration (according to kalibr format, both T_imu_cam and T_cam_imu)</div>
<div class="line">distortion_coeffs: [0.0, 0.0, 0.0, 0.0]</div>
<div class="line">distortion_model: radtan</div>
<div class="line">resolution: [320, 240]</div>
<div class="line">intrinsics: [250.0, 250.0, 160.0, 120.0]</div>
<div class="line">T_imu_cam: </div>
<div class="line">  - [1.0, 0.0, 0.0, 0.0]</div>
<div class="line">  - [0.0, -1.0, 0.0, 0.0]</div>
<div class="line">  - [0.0, 0.0, -1.0, 0.0]</div>
<div class="line">  - [0.0, 0.0, 0.0, 1.0]</div>
<div class="line"> </div>
<div class="line"># Initializer options</div>
<div class="line"># For IMU only motion detection set static_initializer_disparity_threshold: 0.0</div>
<div class="line"># For DISPARITY only motion detection set static_initializer_acc_threshold: 0.0</div>
<div class="line">static_initializer_imu_window: 1.0</div>
<div class="line">static_initializer_disparity_window: 0.5</div>
<div class="line">static_initializer_acc_threshold: 0.25</div>
<div class="line">static_initializer_disparity_threshold: 1.0</div>
<div class="line"> </div>
<div class="line"># Propagator options</div>
<div class="line"># For numerical exponential computation (costly) set state_transition_order: -1</div>
<div class="line"># For approximated first-order exponential computation (recommended on low-power hardware) set state_transition_order: 0</div>
<div class="line">state_transition_order: 0</div>
<div class="line">imu_buffer_max_size: 1000</div>
<div class="line"> </div>
<div class="line"># Updater options</div>
<div class="line"># Possible options for zero_velocity_update are enabled, disabled, beginning</div>
<div class="line">refine_traingulation: true</div>
<div class="line">feature_min_depth: 0.1</div>
<div class="line">feature_max_depth: 20</div>
<div class="line">feature_refinement_max_iterations: 20</div>
<div class="line">feature_refinement_tollerance: 1e-10</div>
<div class="line">measurement_projection_method: unit_plane</div>
<div class="line">feature_representation: anchored_inverse_depth</div>
<div class="line">pixel_standerd_deviation: 1.0</div>
<div class="line">curvature_correction: true</div>
<div class="line">zero_velocity_update: enabled</div>
<div class="line"> </div>
<div class="line"># State options</div>
<div class="line">enable_camera_intrinsic_calibration: false</div>
<div class="line">gravity: 9.81</div>
<div class="line">num_clones: 11</div>
<div class="line"> </div>
<div class="line"># Tracker options</div>
<div class="line"># Possible options for feature_detector are fast and shi-tomasi</div>
<div class="line">equalization_method: histogram</div>
<div class="line">optical_flow_pyramid_levels: 3</div>
<div class="line">detector_pyramid_levels: 1</div>
<div class="line">feature_detector: fast</div>
<div class="line">grid_x_size: 4</div>
<div class="line">grid_y_size: 4</div>
<div class="line">min_feature_pixel_distance: 15</div>
<div class="line">min_features: 100</div>
<div class="line">max_features: 120</div>
<div class="line">fast_threshold: 20</div>
<div class="line">shi_tomasi_quality_level: 0.75</div>
<div class="line"> </div>
<div class="line"># Track Manager</div>
<div class="line">max_track_length: 400</div>
<div class="line"> </div>
<div class="line"># Logger level </div>
<div class="line"># Possible levels are 0: Full, 1: INFO, 2: WARN, 3: ERR, 4: INACTIVE</div>
<div class="line">logger_level: 1</div>
</div><!-- fragment --><p>Adjust values as needed and customize settings thresholds based on your specific requirements.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
License</h2>
<p>This software is made available to the public to use (source-available), licensed under the terms of the BSD-2-Clause-License with no commercial use allowed, the full terms of which are made available in the [LICENSE](LICENSE) file.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
Usage for academic purposes</h3>
<p>If you use this software in an academic research setting, please cite the corresponding papers.</p>
<div class="fragment"><div class="line">@article{fornasier2023msceqf,</div>
<div class="line">  title={MSCEqF: A Multi State Constraint Equivariant Filter for Vision-aided Inertial Navigation},</div>
<div class="line">  author={Fornasier, Alessandro and van Goor, Pieter and Allak, Eren and Mahony, Robert and Weiss, Stephan},</div>
<div class="line">  journal={arXiv preprint arXiv:2311.11649},</div>
<div class="line">  year={2023}</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">@article{fornasier2023equivariant,</div>
<div class="line">  title={Equivariant Symmetries for Inertial Navigation Systems},</div>
<div class="line">  author={Fornasier, Alessandro and Ge, Yixiao and van Goor, Pieter and Mahony, Robert and Weiss, Stephan},</div>
<div class="line">  journal={arXiv preprint arXiv:2309.03765},</div>
<div class="line">  year={2023}</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
References</h2>
<p><a class="anchor" id="1"></a>[1] van Goor, Pieter, Tarek Hamel, and Robert Mahony. "Equivariant filter (eqf)." IEEE Transactions on Automatic Control (2022).</p>
<p><a class="anchor" id="2"></a>[2] Fornasier, Alessandro, et al. "Equivariant filter design for inertial navigation systems with input measurement biases." 2022 International Conference on Robotics and Automation (ICRA). IEEE, 2022.</p>
<p><a class="anchor" id="3"></a>[3] Fornasier, Alessandro, et al. "Overcoming Bias: Equivariant Filter Design for Biased Attitude Estimation with Online Calibration." IEEE Robotics and Automation Letters 7.4 (2022): 12118-12125.</p>
<p><a class="anchor" id="4"></a>[4] Fornasier, Alessandro, et al. "Equivariant Symmetries for Inertial Navigation Systems." ArXiv preprint. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
